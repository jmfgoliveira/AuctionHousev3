<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Bootstrap core CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../css/login.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script>
    	function myFunction() {
        
      	var name = document.getElementById("inputName").value;	
    	 	var email = document.getElementById("inputEmail").value;	
    		var pass = document.getElementById("inputPassword").value;

    		var url = "http://localhost:8080/register";

        var xmlhttp = new XMLHttpRequest();

        var token;
        var time = (new Date()).getTime();


        xmlhttp.open("POST", url, true);

        //xmlhttp.setRequestHeader("Content-Type", "application/json");

        xmlhttp.send(JSON.stringify({name:name, email:email, password:pass, time:time}));

        xmlhttp.onreadystatechange = function() {
        if(xmlhttp.readyState == 4 && xmlhttp.status == 200) {
        //sucessful register
          token = xmlhttp.responseText;
          localStorage.setItem('LoginToken', token);
          localStorage.setItem('Email', email);
          window.location = "../home.html";
          }
          else if(xmlhttp.readyState == 4 && xmlhttp.status == 3) {
          //email already exists - error code 3
            window.alert("Email already registered!");
          }
          
          else if(xmlhttp.readyState == 4) {
            window.alert("Something went wrong! Error:" + xmlhttp.status);
          }
        };

		  }
	   </script>
  </head>

  <body>

	<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
      <a class="navbar-brand" href="home.html">eBay</a>

      <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="../home.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="products.html">Products</a>
          </li>
		  <li class="nav nav-pull-right">
            <a class="nav-link" href="login.html">Sign in</a>
          </li>
		      <li class="nav nav-pull-right">
            <a class="nav-link" href="register.html">Sign up</a>
          </li>
        </ul>
        
      </div>
    </nav>
  
    <div class="container">

      <form class="form-login">
        <h2 class="form-login-heading">Please Register here</h2>
        <label for="inputName" class="sr-only">Name</label>
        <input type="text" id="inputName" class="form-control" placeholder="Name" required autofocus>
        <label for="inputEmail" class="sr-only">Email address</label>
        <input type="email" id="inputEmail" class="form-control" placeholder="Email address" required autofocus>
        <label for="inputPassword" class="sr-only">Password</label>
        <input type="password" id="inputPassword" class="form-control" placeholder="Password" required>
		<label for="inputPassword" class="sr-only">Confirm Password</label>
        <input type="password" id="confirmPassword" class="form-control" placeholder="Confirm Password" required>
              

		</form>
    </div> <!-- /container -->
    <style>
          .button {
              background-color: #1E90FF; /* Blue */
              border: none;
              color: white;
              padding: 16px 32px;
              text-align: center;
              text-decoration: none;
              display: inline-block;
              font-size: 16px;
              margin: 0px 2px;
              cursor: pointer;
          }

          .button4 {border-radius: 12px;}
          .button4 {width: 30%;}
        </style>
    <center><button class="button button4" onclick="javascript:myFunction();">Sign in</button></center>
  </body>
</html>